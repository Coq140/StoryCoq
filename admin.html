<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Admin Panel | InstaClone</title>
<style>
  body { font-family: Arial, sans-serif; background: #fafafa; padding: 20px; }
  table { border-collapse: collapse; width: 100%; }
  th, td { border: 1px solid #ddd; padding: 8px; text-align: left; vertical-align: middle; }
  th { background: #333; color: white; }
  button { padding: 5px 8px; margin: 0 3px; cursor: pointer; }
  .badge {
    font-size: 18px;
    margin-right: 5px;
    cursor: pointer;
    user-select: none;
  }
  .badge:hover {
    opacity: 0.6;
  }
  .logo {
    width: 30px;
    height: 30px;
    vertical-align: middle;
    border-radius: 3px;
    margin-right: 5px;
  }
</style>
</head>
<body>

<h1>Panel Admin</h1>

<table id="usersTable">
  <thead>
    <tr>
      <th>Utilisateur</th>
      <th>Badges (cliquer pour ajouter/enlever)</th>
      <th>Affili√© √†</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
// Ta liste d‚Äôentreprises (logo en URL)
const entreprises = {
  'AcmeCorp': { name: "Acme Corporation", logo: "https://via.placeholder.com/30?text=A" },
  'TechInc': { name: "Tech Incorporated", logo: "https://via.placeholder.com/30?text=T" },
};

// R√©cup√®re ta vraie base utilisateurs depuis localStorage ou cr√©e une base vide
let users = JSON.parse(localStorage.getItem('instaUsers')) || [
  { id: 1, name: "Alice", badges: ["admin", "vip"], affiliateWith: "AcmeCorp" },
  { id: 2, name: "Bob", badges: ["staff"], affiliateWith: "TechInc" },
  { id: 3, name: "Charlie", badges: [], affiliateWith: null }
];

// Liste de tous les badges possibles
const allBadges = ['admin', 'staff', 'vip'];

function saveUsers(){
  localStorage.setItem('instaUsers', JSON.stringify(users));
}

// Fonction pour afficher les badges avec interaction clic (ajout/retrait)
function createBadgeElement(user, badge) {
  const span = document.createElement('span');
  span.className = 'badge';
  span.title = `Badge: ${badge} (cliquer pour toggler)`;
  if(badge === 'admin') span.textContent = 'üõ°Ô∏è';
  else if(badge === 'staff') span.textContent = '‚≠ê';
  else if(badge === 'vip') span.textContent = 'üíé';
  else span.textContent = badge;

  // Si utilisateur poss√®de ce badge, style en gras
  if(user.badges && user.badges.includes(badge)){
    span.style.fontWeight = 'bold';
  }

  // Toggle badge au clic
  span.onclick = () => {
    if(!user.badges) user.badges = [];
    if(user.badges.includes(badge)){
      // retirer
      user.badges = user.badges.filter(b => b !== badge);
      span.style.fontWeight = 'normal';
    } else {
      // ajouter
      user.badges.push(badge);
      span.style.fontWeight = 'bold';
    }
    saveUsers();
  };
  return span;
}

function renderUsers(){
  const tbody = document.querySelector('#usersTable tbody');
  tbody.innerHTML = '';

  users.forEach(user => {
    const tr = document.createElement('tr');

    // Nom utilisateur
    const tdName = document.createElement('td');
    tdName.textContent = user.name;
    tr.appendChild(tdName);

    // Badges (avec clic)
    const tdBadges = document.createElement('td');
    allBadges.forEach(badge => {
      tdBadges.appendChild(createBadgeElement(user, badge));
    });
    tr.appendChild(tdBadges);

    // Affiliation (logo + nom)
    const tdAffiliate = document.createElement('td');
    if(user.affiliateWith && entreprises[user.affiliateWith]){
      const img = document.createElement('img');
      img.src = entreprises[user.affiliateWith].logo;
      img.alt = entreprises[user.affiliateWith].name;
      img.title = entreprises[user.affiliateWith].name;
      img.className = 'logo';
      tdAffiliate.appendChild(img);
      tdAffiliate.appendChild(document.createTextNode(entreprises[user.affiliateWith].name));
    } else {
      tdAffiliate.textContent = '‚Äî';
    }
    tr.appendChild(tdAffiliate);

    // Actions (bouton supprimer)
    const tdActions = document.createElement('td');
    const btnDel = document.createElement('button');
    btnDel.textContent = 'Supprimer';
    btnDel.onclick = () => {
      if(confirm(`Supprimer l'utilisateur ${user.name} ?`)){
        users = users.filter(u => u.id !== user.id);
        saveUsers();
        renderUsers();
      }
    };
    tdActions.appendChild(btnDel);
    tr.appendChild(tdActions);

    tbody.appendChild(tr);
  });
}

renderUsers();
</script>

</body>
</html>
